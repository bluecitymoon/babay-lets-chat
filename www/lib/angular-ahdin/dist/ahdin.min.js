!function(){"use strict";angular.module("ahdin",[])}(),function(){"use strict";function e(e,t,n,r,a,o){function i(e){function t(t){return m(t,e)}function n(t){return c(t,e)}function r(t){return f(t,e)}return h(e),x=e.quality||o,u(e).then(t).then(n).then(r).then(l)}function u(t){function r(){o.resolve(i),n.$apply()}var o=e.defer(),i=new Image;return i.onload=r,i.src=a.createObjectURL(t.sourceFile),o.promise}function m(t,a){function o(e){i.resolve({metaData:e,image:t}),n.$apply()}var i=e.defer();return r.parseMetaData(a.sourceFile,o,a),i.promise}function c(t,a){function o(e){i.resolve(e),n.$apply()}var i=e.defer(),u=s(t,a);return r(a.sourceFile,o,u),i.promise}function s(e,t){var n=e.image,r=e.metaData,a=t&&t.maxHeight||n.height,o=t&&t.maxWidth||n.width,i={maxWidth:o,maxHeight:a};return r.exif&&(i.orientation=r.exif.get("Orientation")),i}function f(n,r){var a=e.defer(),o=r&&r.outputFormat||"jpeg",i="image/"+o,u=t.document.createElement("canvas");u.width=n.width,u.height=n.height,u.getContext("2d").drawImage(n,0,0,u.width,u.height);var m={dataUrl:u.toDataURL(i,x),fileName:r.sourceFile.name};return a.resolve(m),a.promise}function l(r){function o(e){e.name=r.fileName}var i=e.defer(),u=a.dataURLToBlob(r.dataUrl);return u.then(o),i.resolve(u),t.setTimeout(function(){n.$apply()}),i.promise}function d(e){return angular.isNumber(e)&&e>0}function h(e){e=e||{},p(e.sourceFile),g(e.maxWidth),v(e.maxHeight),b(e.outputFormat),w(e.quality)}function p(e){var n=e instanceof t.File||e instanceof t.Blob;if(!n)throw new Error("params.sourceFile must be instance of File")}function g(e){var t=void 0===e||d(e);if(!t)throw new Error("params.maxWidth must be a positive Number")}function v(e){var t=void 0===e||d(e);if(!t)throw new Error("params.maxHeight must be a positive Number")}function b(e){var t=F.indexOf(e)>-1,n=e?t:!0;if(!n)throw new Error("params.outputFormat format must be one of ["+F+"]")}function w(e){var t=void 0===e||e>0&&1>=e;if(!t)throw new Error("params.quality must be a Number over 0 and less or equal to 1")}var x,F=["jpeg","png"];return{compress:i}}angular.module("ahdin").factory("Ahdin",e),e.$inject=["$q","$window","$rootScope","loadImage","blobUtil","QUALITY"]}(),function(){"use strict";angular.module("ahdin").constant("blobUtil",blobUtil).constant("loadImage",loadImage).constant("QUALITY",.8)}();